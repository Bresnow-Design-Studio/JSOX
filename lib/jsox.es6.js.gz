var e=e||{};const t=JSON,n=e;function r(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}!function(){const e="function"==typeof BigInt,r=["ab","u8","cu8","s8","u16","s16","u32","s32","u64","s64","f32","f64"];var s=null,a=null;const i=[ArrayBuffer,Uint8Array,Uint8ClampedArray,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array,null,null,Float32Array,Float64Array],l=29,o=30,c=31,u={true:!0,false:!1,null:null,NaN:NaN,Infinity:1/0,undefined:void 0},f=[];function p(){var e=f.pop();return e||(e={context:0,current_proto:null,current_class:null,current_class_field:0,arrayType:-1,valueType:0,elements:null}),e}function g(e){f.push(e)}const h=[];function b(e){h.push(e)}n.escape=function(e){var t,n="";if(!e)return e;for(t=0;t<e.length;t++)'"'!=e[t]&&"\\"!=e[t]&&"`"!=e[t]&&"'"!=e[t]||(n+="\\"),n+=e[t];return n};const y=new WeakMap,d=new Map,m=new Map,v=[];n.begin=function(t,n){const s={name:null,value_type:0,string:"",contains:null,className:null},a={line:1,col:1};let u,f=0;var y=new Map,d=0,v=!0,k=!1,w=!1,_=null,x=null,O=void 0,N={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last?this.last.next=t:this.first=t,this.last=t,this.length++},pop(){var e=this.last;return e?((this.last=e.prior)||(this.first=null),e.next=this.saved,this.last&&(this.last.next=null),e.next||(e.first=null),this.saved=e,this.length--,e.node):null},length:0,dump(){console.log("STACK LENGTH:",this.length);let e=this.first,t=0;for(;e;)console.log("Context:",t,e.node),t++,e=e.next}},j=[],E={},A=null,I=null,T=0,P=-1,C=0,D=0,M=!1,X=!1,J=!1,F=!1,U=!1,$={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last?this.last.next=t:this.first=t,this.last=t},shift(){var e=this.first;return e?((this.first=e.next)||(this.last=null),e.next=this.saved,this.saved=e,e.node):null},unshift(e){var t=this.saved;this.saved=t.next,t.node=e,t.next=this.first,t.prior=null,this.first||(this.last=t),this.first=t}},B=null,q=!1,H=!1,z=!1,W=!1,L=!1,R=!1,G=!1,Y=0,K=0,V=!1,Q=!1,Z=!1;function ee(e){throw new Error(`${e} at ${f} [${a.line}:${a.col}]`)}return{fromJSOX(e,t,n){if(y.get(e))throw new Error("Existing fromJSOX has been registered for prototype");if(t||(t=function(){}),t&&!("constructor"in t))throw new Error("Please pass a prototype like thing...");y.set(e,{protoCon:t.prototype.constructor,cb:n})},registerFromJSOX(e,t){throw new Error("registerFromJSOX is deprecated, please update to use fromJSOX instead:"+e+t.toString())},finalError(){0!==D&&(1===D&&ee("Comment began at end of document"),2===D&&console.log("Warning: '//' comment without end of line ended document"),3===D&&ee("Open comment '/*' is missing close at end of document"),4===D&&ee("Incomplete '/* *' close at end of document")),q&&ee("Incomplete string")},value(){this.finalError();var e=_;return _=void 0,e},reset(){d=0,v=!0,$.last&&($.last.next=$.save),$.save=$.first,$.first=$.last=null,N.last&&(N.last.next=N.save),N.length=0,N.save=$.first,N.first=N.last=null,O=void 0,C=0,j=[],E={},A=null,I=null,T=0,s.value_type=0,s.name=null,s.string="",s.className=null,a.line=1,a.col=1,w=!1,D=0,V=!1,q=!1,z=!1,W=!1,Q=!1},usePrototype(e,t){E[e]=t},write(e){var r;for("string"!=typeof e&&void 0!==e&&(e=String(e)),r=this._write(e,!1);r>0&&("function"==typeof n&&function e(t,r){var s,a,i=t[r];if(i&&"object"==typeof i)for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(void 0!==(a=e(i,s))?i[s]=a:delete i[s]);return n.call(t,r,i)}({"":_},""),_=t(_),!(r<2));r=this._write());},_write(t,n){var E,ee,te,ne=0;function re(e,t){throw new Error(`${e} '${String.fromCodePoint(t)}' unexpected at ${f} (near '${te.substr(f>4?f-4:0,f>4?3:f-1)}[${String.fromCodePoint(t)}]${te.substr(f,10)}') [${a.line}:${a.col}]`)}function se(){s.value_type=0,s.string="",s.contains=null}function ae(){var t=null;switch(s.value_type){case 5:if(!(s.string.length>13||13==s.string.length&&s[0]>"2")||Q||U||F||X||(Z=!0),Z){if(e)return BigInt(s.string);throw new Error("no builtin BigInt()",0)}if(Q){const e=new Date(s.string);return isNaN(e.getTime())&&re("Bad number format",E),e}return(w?-1:1)*Number(s.string);case 4:if(s.className){if((t=y.get(s.className))||(t=m.get(s.className)),t&&t.cb)return s.className=null,t.cb.call(s.string);throw new Error("Double string error, no constructor for: new "+s.className+"("+s.string+")")}return s.string;case 2:return!0;case 3:return!1;case 7:case 8:return NaN;case 9:return-1/0;case 10:return 1/0;case 1:return null;case-1:case 12:return;case 6:return s.className&&((t=y.get(s.className))||(t=m.get(s.className)),s.className=null,t&&t.cb)?s.contains=t.cb.call(s.contains):s.contains;case 13:if(P>=0){let e;return e=s.contains.length?S(s.contains[0]):S(s.string),0===P?e:new i[P](e)}if(-2===P){var n=x;let e;for(e=0;e<s.contains.length;e++){const t=s.contains[e];let r=n[t];if(!r){let t=N.first,a=0;for(;t&&a<s.contains.length&&a<N.length;){const i=s.contains[a];if(t.next)if("number"==typeof i){const e=t.next.node.elements,s=t.next.node.elements;if(e&&i>=e.length){if(a===s.length-1){r=O;break}if(t.next.next&&i===e.length){r=t.next.next.node.elements,t=t.next,a++,n=r;continue}r=O;break}}else{if(i!==t.next.node.name){r=t.next.node.elements[i],e=a;break}r=13===t.next.node.valueType?t.next.node.elements_array:t.next.node.elements[i]}else r=r[i];t=t.next,a++}e=a}if(!r)throw new Error("Path did not resolve poperly."+s.contains+" at "+t+"("+e+")");n=r}return P=-3,n}return s.className&&((t=y.get(s.className))||(t=m.get(s.className)),s.className=null,t&&t.cb)?t.cb.call(s.contains):s.contains;default:console.log("Unhandled value conversion.",s)}}function ie(){if(-3==P)return 6===s.value_type&&O.push(s.contains),void(P=-1);switch(s.value_type){case 12:O.push(void 0),delete O[O.length-1];break;default:O.push(ae())}se()}function le(){if(-3===P)return O[s.name]=ae(),void(P=-1);12!==s.value_type&&(!s.name&&I&&(s.name=I.fields[T++]),O[s.name]=ae(),se())}function oe(e){if(0!==d){switch(w&&re("Negative outside of quotes, being converted to a string (would lose count of leading '-' characters)",e),d){case c:switch(s.value_type){case 2:s.string+="true";break;case 3:s.string+="false";break;case 1:s.string+="null";break;case 10:s.string+="Infinity";break;case 9:s.string+="-Infinity",re("Negative outside of quotes, being converted to a string",e);break;case 8:s.string+="NaN";break;case 7:s.string+="-NaN",re("Negative outside of quotes, being converted to a string",e);break;case-1:s.string+="undefined";break;case 4:case 0:break;default:console.log("Value of type "+s.value_type+" is not restored...")}break;case 1:s.string+="t";break;case 2:s.string+="tr";break;case 3:s.string+="tru";break;case 5:s.string+="f";break;case 6:s.string+="fa";break;case 7:s.string+="fal";break;case 8:s.string+="fals";break;case 9:s.string+="n";break;case 10:s.string+="nu";break;case 11:s.string+="nul";break;case 12:s.string+="u";break;case 13:s.string+="un";break;case 14:s.string+="und";break;case 15:s.string+="unde";break;case 16:s.string+="undef";break;case 17:s.string+="undefi";break;case 18:s.string+="undefin";break;case 19:s.string+="undefine";break;case 20:s.string+="M";break;case 21:s.string+="Na";break;case 22:s.string+="I";break;case 23:s.string+="In";break;case 24:s.string+="Inf";break;case 25:s.string+="Infi";break;case 26:s.string+="Infin";break;case 27:s.string+="Infini";break;case 28:s.string+="Infinit";break;case 0:case l:case o:break;case 32:re("String-keyword recovery fail (after whitespace)",e)}s.value_type=4,d<l&&(d=c)}else d=c,s.value_type=4;if(123==e)fe();else if(91==e)pe();else if(44==e);else{if(32==e||13==e||10==e||9==e||65279==e||8232==e||8233==e)return;44==e||125==e||93==e||58==e?re("Invalid character near identifier",e):s.string+=u}}function ce(e){let t=0;for(;0==t&&f<te.length;){u=te.charAt(f);let n=te.codePointAt(f++);if(n>=65536&&(u+=te.charAt(f),f++),a.col++,n==e)z?(G?re("Incomplete hexidecimal sequence",n):R?re("Incomplete long unicode sequence",n):L&&re("Incomplete unicode sequence",n),W?(W=!1,t=1):s.string+=u,z=!1):t=1;else if(z){if(L){if(125==n){s.string+=String.fromCodePoint(Y),L=!1,R=!1,z=!1;continue}if(Y*=16,n>=48&&n<=57)Y+=n-48;else if(n>=65&&n<=70)Y+=n-65+10;else{if(!(n>=97&&n<=102)){re("(escaped character, parsing hex of \\u)",n),t=-1,L=!1,z=!1;continue}Y+=n-97+10}continue}if(G||R){if(0===K&&123===n){L=!0;continue}if(K<2||R&&K<4){if(Y*=16,n>=48&&n<=57)Y+=n-48;else if(n>=65&&n<=70)Y+=n-65+10;else{if(!(n>=97&&n<=102)){re(R?"(escaped character, parsing hex of \\u)":"(escaped character, parsing hex of \\x)",n),t=-1,G=!1,z=!1;continue}Y+=n-97+10}K++,R?4==K&&(s.string+=String.fromCodePoint(Y),R=!1,z=!1):2==K&&(s.string+=String.fromCodePoint(Y),G=!1,z=!1);continue}}switch(n){case 13:W=!0,a.col=1;continue;case 8232:case 8233:a.col=1;case 10:W?W=!1:a.col=1,a.line++;break;case 116:s.string+="\t";break;case 98:s.string+="\b";break;case 110:s.string+="\n";break;case 114:s.string+="\r";break;case 102:s.string+="\f";break;case 48:s.string+="\0";break;case 120:G=!0,K=0,Y=0;continue;case 117:R=!0,K=0,Y=0;continue;default:s.string+=u}z=!1}else 92===n?z?(s.string+="\\",z=!1):(z=!0,Y=0,K=0):(W&&(W=!1,a.line++,a.col=2),s.string+=u)}return t}function ue(){let e;for(;(e=f)<te.length;){u=te.charAt(e);let t=te.codePointAt(f++);if(t>=256){f=e;break}if(95!=t)if(a.col++,t>=48&&t<=57)J&&(U=!0),s.string+=u;else if(45==t||43==t)0==s.string.length||J&&!F&&!U?(45!=t||J||(w=!w),s.string+=u,F=!0):(s.string+=u,Q=!0);else{if(78==t){if(0==d)return H=!1,void(d=20);re("fault while parsing number;",t);break}if(73==t){if(0==d)return H=!1,void(d=22);re("fault while parsing number;",t);break}if(58==t&&Q)s.string+=u,Q=!0;else if(84==t&&Q)s.string+=u,Q=!0;else if(90==t&&Q)s.string+=u,Q=!0;else if(46==t){if(X||M||J){v=!1,re("fault while parsing number;",t);break}s.string+=u,X=!0}else{if(110==t){Z=!0;break}if(120==t||98==t||111==t||88==t||66==t||79==t){if(M||"0"!=s.string){v=!1,re("fault while parsing number;",t);break}M=!0,s.string+=u}else{if(101!=t&&69!=t){if(32==t||13==t||10==t||9==t||47==t||35==t||44==t||125==t||93==t||123==t||91==t||34==t||39==t||96==t||58==t){f=e;break}n&&(v=!1,re("fault while parsing number;",t));break}if(J){v=!1,re("fault while parsing number;",t);break}s.string+=u,J=!0}}}}n||f!=te.length?(H=!1,s.value_type=5,0==C&&(V=!0)):H=!0}function fe(){let e,t,n=null,r={};if(d>0&&d<l&&oe(123),t=ge(),0==C)if(d==l||d==c&&(t||s.string.length)){if(t&&t.protoDef&&t.protoDef.protoCon&&(r=new t.protoDef.protoCon,e=2),!t||!t.protoDef&&s.string){if(n=j.find((e=>e.name===s.string)),n)k?(n.fields.length=0,e=4):(r=new n.protoCon,e=5);else{function a(){}j.push(n={name:s.string,protoCon:t&&t.protoDef&&t.protoDef.protoCon||a.constructor,fields:[]}),e=4}k=!1}I=n,d=0}else d=l,e=2;else if(d==l||1===C||3===C||5==C)if(0!=d||4==s.value_type){if(t&&t.protoDef)s.className=s.string,r=new t.protoDef.protoCon,e=2;else{if(n=j.find((e=>e.name===s.string)),n)e=5;else{function a(){}y.set(s.string,{protoCon:a.prototype.constructor,cb:null}),O=new a,e=2}r={}}d=0}else e=2,d=0;else{if(2==C&&0==d)return re("fault while parsing; getting field name unexpected ",E),v=!1,!1;e=2}let i=p();return s.value_type=6,0===C?(O=r,e=2):1==C||3!=C&&5!=C||(!s.name&&I&&(s.name=I.fields[T++]),O[s.name]=r),i.context=C,i.elements=O,i.name=s.name,i.current_proto=A,i.current_class=I,i.current_class_field=T,i.valueType=s.value_type,i.arrayType=-1==P?-3:P,i.className=s.className,s.className=null,s.name=null,A=t,I=n,T=0,O=r,x||(x=O),N.push(i),se(),C=e,!0}function pe(){if(d>0&&d<l&&oe(91),d==c&&s.string.length){var e=r.findIndex((e=>e===s.string));e>=0?(d=0,P=e,s.className=s.string,s.string=null):"ref"===s.string?(s.className=null,P=-2):y.get(s.string)||m.get(s.string)?s.className=s.string:re(`Unknown type '${s.string}' specified for array`,E)}else if(2==C||d==l||d==o)return re("Fault while parsing; while getting field name unexpected",E),v=!1,!1;{let e=p();s.value_type=13;let t=[];0==C?O=t:1==C?-1==P&&O.push(t):3==C&&(O[s.name]=t),e.context=C,e.elements=O,e.name=s.name,e.current_proto=A,e.current_class=I,e.current_class_field=T,e.valueType=s.value_type,e.arrayType=-1==P?-3:P,e.className=s.className,P=-1,s.className=null,s.name=null,A=null,I=null,T=0,O=t,x||(x=t),N.push(e),se(),C=1}return!0}function ge(){const e={protoDef:null,cls:null};return((e.protoDef=y.get(s.string))||(e.protoDef=m.get(s.string)))&&(s.className||(s.className=s.string,s.string=null)),s.string&&(e.cls=j.find((e=>e.name===s.string))),e.protoDef||e.cls?e:null}if(!v)return-1;for(t&&t.length?((ee=function(){var e=h.pop();return e?e.n=0:e={buf:null,n:0},e}()).buf=t,$.push(ee)):(H&&(H=!1,s.value_type=5,0==C&&(V=!0),ne=1),0!==C&&re("Unclosed object at end of stream.",E));v&&(ee=$.shift());){if(f=ee.n,te=ee.buf,q){let e=ce(B);e<0?v=!1:e>0&&(q=!1,v&&(s.value_type=4))}for(H&&ue();!V&&v&&f<te.length;)if(u=te.charAt(f),(E=te.codePointAt(f++))>=65536&&(u+=te.charAt(f),f++),a.col++,D)if(1==D)if(42==E)D=3;else{if(47!=E)return re("fault while parsing;",E);D=2}else 2==D?10!=E&&13!=E||(D=0):3==D?42==E&&(D=4):D=47==E?0:3;else{switch(E){case 47:D=1;break;case 123:fe();break;case 91:pe();break;case 58:if(5==C)d=0,s.name=s.string,s.string="",s.value_type=0;else if(2==C||4==C)if(4==C){if(!Object.keys(O).length){console.log("This is a full object, not a class def...",s.className);const e=()=>{};y.set(N.last.node.current_class.name,{protoCon:e.prototype.constructor,cb:null}),O=new e,C=3,s.name=s.string,d=0,s.string="",s.value_type=0,console.log("don't do default;s do a revive...")}}else 0!=d&&d!=c&&d!=l&&d!=o&&oe(32),d=0,s.name=s.string,s.string="",C=2===C?3:6,s.value_type=0;else{if(0==C){console.log("Override colon found, allow class redefinition",C),k=!0;break}re(1==C?"(in array, got colon out of string):parsing fault;":3==C?"String unexpected":"(outside any object, got colon out of string):parsing fault;",E),v=!1}break;case 125:if(d==c&&(d=0),4==C)if(I){s.string&&I.fields.push(s.string),se();let e=N.pop();C=0,d=0,s.name=e.name,O=e.elements,I=e.current_class,T=e.current_class_field,P=e.arrayType,s.value_type=e.valueType,s.className=e.className,x=null,g(e)}else re("State error; gathering class fields, and lost the class",E);else if(2==C||5==C){0!=s.value_type&&(I&&(s.name=I.fields[T++]),le()),s.value_type=6,A&&A.protoDef&&(console.log("SOMETHING SHOULD AHVE BEEN REPLACED HERE??",A),console.log("The other version only revives on init"),O=new A.protoDef.cb(O,void 0,void 0)),s.contains=O,s.string="";let e=N.pop();C=e.context,s.name=e.name,O=e.elements,I=e.current_class,A=e.current_proto,T=e.current_class_field,P=e.arrayType,s.value_type=e.valueType,s.className=e.className,g(e),0==C&&(V=!0)}else if(3==C){0===s.value_type&&re("Fault while parsing; unexpected",E),le(),s.value_type=6,s.contains=O,d=0;var he=N.pop();C=he.context,s.name=he.name,O=he.elements,A=he.current_proto,I=he.current_class,T=he.current_class_field,P=he.arrayType,s.value_type=he.valueType,s.className=he.className,g(he),0==C&&(V=!0)}else re("Fault while parsing; unexpected",E),v=!1;w=!1;break;case 93:if(d>=o&&(d=0),1==C){0!=s.value_type&&(s.name&&console.log("Ya this should blow up"),ie()),s.contains=O;{let e=N.pop();s.name=e.name,s.className=e.className,C=e.context,O=e.elements,A=e.current_proto,I=e.current_class,T=e.current_class_field,P=e.arrayType,s.value_type=e.valueType,g(e)}s.value_type=13,0==C&&(V=!0)}else re(`bad context ${C}; fault while parsing`,E),v=!1;w=!1;break;case 44:d<o&&0!=d&&oe(E),d!=c&&d!=l||(d=0),4==C?I?(I.fields.push(s.string),s.string="",d=l):re("State error; gathering class fields, and lost the class",E):2==C?I?(s.name=I.fields[T++],0!=s.value_type&&(le(),se())):(s.string||s.value_type)&&re("State error; comma in field name and/or lost the class",E):5==C?(I?(-3==P||s.name||(s.name=I.fields[T++]),0!=s.value_type&&(-3!=P&&le(),se())):0!=s.value_type&&(le(),se()),s.name=null):1==C?(0==s.value_type&&(s.value_type=12),ie(),se(),d=0):3==C&&0!=s.value_type?(C=2,0!=s.value_type&&(le(),se()),d=0):(v=!1,re("bad context; excessive commas while parsing;",E)),w=!1;break;default:switch(E){default:if(0!=C&&(3!=C||d!=l)&&2!=C&&d!=l&&4!=C){if(0==d&&(E>=48&&E<=57||43==E||46==E||45==E))M=!1,J=!1,Q=!1,Z=!1,F=!1,U=!1,X=!1,s.string=u,ee.n=f,ue();else if(0==s.value_type)0!=d?oe(E):(d=c,s.string+=u,s.value_type=4);else if(2==C)re("Multiple values found in field name",E);else if(3==C)if(4!=s.value_type&&(6!=s.value_type&&13!=s.value_type||re("String unexpected",E),oe(E)),d==o){ge()?s.string=u:re("String unexpected",E)}else d==c?s.string+=u:re("String unexpected",E);else if(1==C){if(d==o){s.className||(s.className=s.string,s.string=""),s.string+=u;break}d==c&&(s.string+=u)}break}switch(E){case 96:case 34:case 39:if(0==d||d==l){s.string.length&&(console.log("IN ARRAY AND FIXING?"),s.className=s.string,s.string=""),ce(E)?s.value_type=4:(B=E,q=!0)}else re("fault while parsing; quote not at start of field name",E);break;case 10:a.line++,a.col=1;case 13:case 32:case 8232:case 8233:case 9:case 65279:if(0===C&&d===c){d=0,0===C&&(V=!0);break}if(0===d||d===o){0==C&&s.value_type&&(V=!0);break}if(d===l){if(0===C){d=0,V=!0;break}s.string.length&&console.log("STEP TO NEXT TOKEN."),d=o}else v=!1,re("fault while parsing; whitepsace unexpected",E);break;default:if(0==d&&(E>=48&&E<=57||43==E||46==E||45==E)){M=!1,J=!1,Q=!1,Z=!1,F=!1,U=!1,X=!1,s.string=u,ee.n=f,ue();break}if(d===o&&(v=!1,re("fault while parsing; character unexpected",E)),0===d){d=l,s.value_type=4,s.string+=u;break}if(0==s.value_type)0!==d&&d!==c&&oe(E);else{if(d===c||d===l){s.string+=u;break}if(2==C){if(d==l){s.string+=u;break}re("Multiple values found in field name",E)}3==C&&re("String unexpected",E)}}break;case 96:case 34:case 39:ce(E)?(s.value_type=4,d=c):(B=E,q=!0);break;case 10:a.line++,a.col=1;case 32:case 9:case 13:case 8232:case 8233:case 65279:if(d==c){if(0==C){d=0,V=!0;break}if(3==C){d=32;break}if(2==C){d=o;break}if(1==C){d=o;break}}if(0==d||d==o)break;d==l?s.string.length&&(d=o):d<c&&oe(E);break;case 116:0==d?d=1:27==d?d=28:oe(E);break;case 114:1==d?d=2:oe(E);break;case 117:2==d?d=3:9==d?d=10:0==d?d=12:oe(E);break;case 101:3==d?(s.value_type=2,d=c):8==d?(s.value_type=3,d=c):14==d?d=15:18==d?d=19:oe(E);break;case 110:0==d?d=9:12==d?d=13:17==d?d=18:22==d?d=23:25==d?d=26:oe(E);break;case 100:13==d?d=14:19==d?(s.value_type=-1,d=c):oe(E);break;case 105:16==d?d=17:24==d?d=25:26==d?d=27:oe(E);break;case 108:10==d?d=11:11==d?(s.value_type=1,d=c):6==d?d=7:oe(E);break;case 102:0==d?d=5:15==d?d=16:23==d?d=24:oe(E);break;case 97:5==d?d=6:20==d?d=21:oe(E);break;case 115:7==d?d=8:oe(E);break;case 73:0==d?d=22:oe(E);break;case 78:0==d?d=20:21==d?(s.value_type=w?7:8,w=!1,d=c):oe(E);break;case 121:28==d?(s.value_type=w?9:10,w=!1,d=c):oe(E);break;case 45:0==d?w=!w:oe(E)}}if(V){d==c&&(d=0);break}}if(f==te.length?(b(ee),q||H||2==C?ne=0:0!=C||0==s.value_type&&!_||(V=!0,ne=1)):(ee.n=f,$.unshift(ee),ne=2),V){x=null;break}}return v?(V&&0!=s.value_type&&(d=0,_=ae(),w=!1,s.string="",s.value_type=0),V=!1,ne):-1}}};const k=[Object.freeze(n.begin())];var w=0;function _(){return this&&this.valueOf()}n.parse=function(e,t){var r,s=w++;k.length<=s&&k.push(Object.freeze(n.begin())),r=k[s],"string"!=typeof e&&(e=String(e)),r.reset();const a=r._write(e,!0);if(a>0){var i=r.value();if(void 0===i&&a>1)throw new Error("Pending value could not complete");return i="function"==typeof t?function e(n,r){var s,a,i=n[r];if(i&&"object"==typeof i)for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(void 0!==(a=e(i,s))?i[s]=a:delete i[s]);return console.log("SO this calls deeply?",r,i),t.call(n,r,i)}({"":i},""):i,w--,i}r.finalError()},y.set(Object.prototype,{external:!1,name:Object.prototype.constructor.name,cb:null}),y.set(Date.prototype,{external:!1,name:"Date",cb:function(){var e,t,n=-this.getTimezoneOffset(),r=n>=0?"+":"-",s=function(e){var t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return[this.getFullYear(),"-",s(this.getMonth()+1),"-",s(this.getDate()),"T",s(this.getHours()),":",s(this.getMinutes()),":",s(this.getSeconds()),"."+(e=this.getMilliseconds(),t=Math.floor(Math.abs(e)),(t<100?"0":"")+(t<10?"0":"")+t)+r,s(n/60),":",s(n%60)].join("")}}),y.set(Boolean.prototype,{external:!1,name:"Boolean",cb:_}),y.set(Number.prototype,{external:!1,name:"Number",cb:function(){return isNaN(this)?"NaN":isFinite(this)?String(this):this<0?"-Infinity":"Infinity"}}),y.set(String.prototype,{external:!1,name:"String",cb:function(){return'"'+n.escape(_.apply(this))+'"'}}),"function"==typeof BigInt&&y.set(BigInt.prototype,{external:!1,name:"BigInt",cb:function(){return this+"n"}}),y.set(ArrayBuffer.prototype,{external:!0,name:"ab",cb:function(){return"["+j(this)+"]"}}),y.set(Uint8Array.prototype,{external:!0,name:"u8",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Uint8ClampedArray.prototype,{external:!0,name:"uc8",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Int8Array.prototype,{external:!0,name:"s8",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Uint16Array.prototype,{external:!0,name:"u16",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Int16Array.prototype,{external:!0,name:"s16",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Uint32Array.prototype,{external:!0,name:"u32",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Int32Array.prototype,{external:!0,name:"s32",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Float32Array.prototype,{external:!0,name:"f32",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Float64Array.prototype,{external:!0,name:"f64",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Float64Array.prototype,{external:!0,name:"f64",cb:function(){return"["+j(this.buffer)+"]"}}),y.set(Map.prototype,a={external:!0,name:"map",cb:null}),m.set("map",{protoCon:Map.constructor,cb:function(e,t){return e&&this.set(e,t),this}}),y.set(Array.prototype,s={external:!1,name:Array.prototype.constructor.name,cb:null}),n.defineClass=function(e,t){for(var n,r=Object.keys(t),s=1;s<r.length;s++){var a,i;(a=r[s-1])>(i=r[s])&&(r[s-1]=i,r[s]=a,s?s-=2:s--)}v.push(n={name:e,tag:r.toString(),proto:Object.getPrototypeOf(t),fields:Object.keys(t)});for(var l=1;l<n.fields.length;l++)if(n.fields[l]<n.fields[l-1]){let e=n.fields[l-1];n.fields[l-1]=n.fields[l],n.fields[l]=e,l>1&&(l-=2)}n.proto===Object.getPrototypeOf({})&&(n.proto=null)},n.toJSOX=n.registerToJSOX=function(e,t,n){if(t.prototype&&t.prototype===Object.prototype){var r=Object.keys(t).toString();if(d.get(r))throw new Error("Existing toJSOX has been registered for object type");d.set(r,{external:!0,name:e,cb:n})}else{if(y.get(t.prototype))throw new Error("Existing toJSOX has been registered for prototype");y.set(t.prototype,{external:!0,name:e||n.constructor.name,cb:n})}},n.fromJSOX=function(e,t,n){if(t||(t=function(){}.prototype),m.get(e))throw new Error("Existing fromJSOX has been registered for prototype");if(t&&!("constructor"in t))throw new Error("Please pass a prototype like thing...");m.set(e,{protoCon:t.prototype.constructor,cb:n})},n.registerFromJSOX=function(e,t){throw new Error("deprecated; please adjust code to use fromJSOX:"+e+t.toString())},n.addType=function(e,t,r,s){n.toJSOX(e,t,r),n.fromJSOX(e,t,s)},n.registerToFrom=function(e,t){throw new Error("registerToFrom deprecated; please use addType:"+e+t.toString())},n.stringifier=function(){var e=[],r='"';let i=new WeakMap;const l=[];var o=[];const c=new WeakMap,f=new Map;let p=null;const g=[];let h=!1;const b={defineClass(t,n){for(var r,s=Object.keys(n),a=1;a<s.length;a++){var i,l;(i=s[a-1])>(l=s[a])&&(s[a-1]=l,s[a]=i,a?a-=2:a--)}e.push(r={name:t,tag:s.toString(),proto:Object.getPrototypeOf(n),fields:Object.keys(n)});for(var o=1;o<r.fields.length;o++)if(r.fields[o]<r.fields[o-1]){let e=r.fields[o-1];r.fields[o-1]=r.fields[o],r.fields[o]=e,o>1&&(o-=2)}r.proto===Object.getPrototypeOf({})&&(r.proto=null)},setDefaultObjectToJSOX(e){p=e},isEncoding:e=>!!o.find(((t,n)=>t===e&&n<o.length-1)),encodeObject(e){return p?p.apply(e,[this]):e},stringify:(t,v,w)=>function(t,v,w){if(void 0===t)return"undefined";if(null===t)return;var _,x,O,N,j=!0;const S=typeof w,E=typeof v;if(_="",x="","number"===S)for(N=0;N<w;N+=1)x+=" ";else"string"===S&&(x=w);if(O=v,v&&"function"!==E&&("object"!==E||"number"!=typeof v.length))throw new Error("JSOX.stringify");return l.length=0,i=new WeakMap,I("",{"":t});function A(e){return isNaN(e)?e in u||/([0-9-])/.test(e[0])||/((\n|\r|\t)|[ {}()<>!+*/.:,-])/.test(e)?r+n.escape(e)+r:e:["'",e.toString(),"'"].join("")}function I(t,n){function r(){var e=[];let t=l.length;for(let n=0;n<this.length;n+=1)l[t]=n,e[n]=I(n,this)||"null";return l.length=t,o.length=t,0===e.length?"[]":_?["[\n",_,e.join(",\n"+_),"\n",T,"]"].join(""):"["+e.join(",")+"]"}function i(){var e={tmp:null},t="{",n=!0;for(var[r,s]of this){e.tmp=s;var a=l.length;l[a]=r,t+=(n?"":",")+A(r)+":"+I("tmp",e),l.length=a,n=!1}return t+="}"}var u,v,w,N;j&&(s.cb=r,a.cb=i,j=!1),s.cb=r;var S,E,T=_;let P=l.length;var C=n[t];let D,M="object"==typeof C;M&&null!==C&&p&&(g.find((e=>e===C))||(g.push(C),o[P]=C,M="object"==typeof(C=p.apply(C,[b])),g.pop(),o.length=P,M="object"==typeof C));var X=null!=C&&(c.get(Object.getPrototypeOf(C))||y.get(Object.getPrototypeOf(C))||null),J=!X&&null!=C&&(f.get(Object.keys(C).toString())||d.get(Object.keys(C).toString())||null),F=X&&X.cb||J&&J.cb;if(null!=C&&"function"==typeof F){if(_+=x,"object"==typeof C&&(w=m(C)))return"ref"+w;let e=F.apply(C);C=e,_=T}else if("object"==typeof C&&(w=m(C)))return"ref"+w;switch("function"==typeof O&&(C=O.call(n,t,C)),typeof C){case"string":case"number":{let n="";return""===t&&(n=e.map((e=>e.name+"{"+e.fields.join(",")+"}")).join(_?"\n":"")+(_?"\n":"")),X&&X.external?n+X.name+C:J&&J.external?n+J.name+C:n+C}case"boolean":case"null":return String(C);case"object":if(w)return"ref"+w;if(!C)return"null";if(_+=x,S=null,E=[],O&&"object"==typeof O){for(N=O.length,S=k(C,O),u=0;u<N;u+=1)"string"==typeof O[u]&&(v=O[u],l[P]=v,(w=I(v,C))&&(S?E.push(w):E.push(A(v)+(_?": ":":")+w)));l.splice(P,1)}else{S=k(C);var U=[];for(v in C)if((!h||Object.prototype.propertyIsEnumerable.call(C,v))&&Object.prototype.hasOwnProperty.call(C,v)){var $;for($=0;$<U.length;$++)if(U[$]>v){U.splice($,0,v);break}$==U.length&&U.push(v)}for($=0;$<U.length;$++)v=U[$],Object.prototype.hasOwnProperty.call(C,v)&&(l[P]=v,(w=I(v,C))&&(S?E.push(w):E.push(A(v)+(_?": ":":")+w)));l.splice(P,1)}D=""===t?e.map((e=>e.name+"{"+e.fields.join(",")+"}")).join(_?"\n":"")+(_?"\n":""):"",X&&X.external&&(""===t?D+=X.name:D=D+'"'+X.name+'"');var B=null;return S&&(B=A(S.name)),w=D+(0===E.length?"{}":_?(S?B:"")+"{\n"+_+E.join(",\n"+_)+"\n"+T+"}":(S?B:"")+"{"+E.join(",")+"}"),_=T,w}}}(t,v,w),setQuote(e){r=e},registerToJSOX(e,t,n){if(t.prototype&&t.prototype!==Object.prototype){if(c.get(t))throw new Error("Existing toJSOX has been registered for prototype");c.set(t,{external:!0,name:e||n.constructor.name,cb:n})}else{var r=Object.keys(t).toString();if(f.get(r))throw new Error("Existing toJSOX has been registered for object type");f.set(r,{external:!0,name:e,cb:n})}},get ignoreNonEnumerable(){return h},set ignoreNonEnumerable(e){h=e}};return b;function m(e){if(null!==e){var n=i.get(e);if(n)return n;i.set(e,t.stringify(l))}}function k(t,n){var r,s,a=Object.getPrototypeOf(t);if(s=e.find((e=>{if(e.proto&&e.proto===a)return!0})))return s;if(e.length||v.length){if(n)n=n.map((e=>"string"==typeof e?e:void 0)),r=n.toString();else{for(var i=Object.keys(t),l=1;l<i.length;l++){var o,c;(o=i[l-1])>(c=i[l])&&(i[l-1]=c,i[l]=o,l?l-=2:l--)}r=i.toString()}(s=e.find((e=>{if(e.tag===r)return!0})))||(s=v.find((e=>{if(e.tag===r)return!0})))}return s}};const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O={"~":-1,"=":-1,$:62,_:63,"+":62,"-":62,".":62,"/":63,",":63};for(var N=0;N<256;N++)N<64&&(O[x[N]]=N);function j(e){for(var t,n="",r=new Uint8Array(e),s=r.byteLength,a=s%3,i=s-a,l=0;l<i;l+=3)t=r[l]<<16|r[l+1]<<8|r[l+2],n+=x[(16515072&t)>>18]+x[(258048&t)>>12]+x[(4032&t)>>6]+x[63&t];return 1==a?(t=r[i],n+=x[(252&t)>>2]+x[(3&t)<<4]+"=="):2==a&&(t=r[i]<<8|r[i+1],n+=x[(64512&t)>>10]+x[(1008&t)>>4]+x[(15&t)<<2]+"="),n}function S(e){var t;t=e.length%4==1?3*((e.length+3)/4|0)-3:e.length%4==2?3*((e.length+3)/4|0)-2:e.length%4==3?3*((e.length+3)/4|0)-1:-1==O[e[e.length-3]]?3*((e.length+3)/4|0)-3:-1==O[e[e.length-2]]?3*((e.length+3)/4|0)-2:-1==O[e[e.length-1]]?3*((e.length+3)/4|0)-1:3*((e.length+3)/4|0);var n,r=new ArrayBuffer(t),s=new Uint8Array(r),a=e.length+3>>2;for(n=0;n<a;n++){var i=O[e[4*n]],l=4*n+1<e.length?O[e[4*n+1]]:-1,o=l>=0&&4*n+2<e.length?O[e[4*n+2]]:-1,c=o>=0&&4*n+3<e.length?O[e[4*n+3]]:-1;l>=0&&(s[3*n+0]=i<<2|l>>4),o>=0&&(s[3*n+1]=l<<4|o>>2&15),c>=0&&(s[3*n+2]=o<<6|63&c)}return r}Object.freeze(O),n.stringify=function(e,t,r){return n.stringifier().stringify(e,t,r)},[[0,256,[16767487,16739071,130048,3670016,0,16777208,16777215,8388607]]].map((e=>({firstChar:e[0],lastChar:e[1],bits:e[2]})))}();var s=r(Object.freeze({__proto__:null}));export default s;
