var exports$1=exports$1||{};const _JSON=JSON;var JSOX=exports$1;function privateizeEverything(){const e="function"==typeof BigInt,t=-1,n=0,r=1,a=2,s=3,i=4,l=5,o=6,c=7,u=8,f=9,p=10,g=12,h=13,b=["ab","u8","cu8","s8","u16","s16","u32","s32","u64","s64","f32","f64"];var y=null,m=null;const d=[ArrayBuffer,Uint8Array,Uint8ClampedArray,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array,null,null,Float32Array,Float64Array],v=0,k=1,O=2,j=3,x=5,w=6,_=7,N=8,S=9,A=10,I=11,J=12,P=13,X=14,E=15,M=16,$=17,C=18,F=19,U=20,B=21,T=22,q=23,z=24,D=25,W=26,H=27,L=28,Q=29,R=30,V=31,Y=0,G=1,K=3,Z=4,ee=5,te=6,ne={true:!0,false:!1,null:null,NaN:NaN,Infinity:1/0,undefined:void 0},re=[];function ae(){var e=re.pop();return e||(e={context:Y,current_class:null,current_class_field:0,arrayType:-1,elements:null,element_array:null}),e}function se(e){re.push(e)}const ie=[];function le(e){ie.push(e)}JSOX.escape=function(e){var t,n="";if(!e)return e;for(t=0;t<e.length;t++)'"'!=e[t]&&"\\"!=e[t]&&"`"!=e[t]&&"'"!=e[t]||(n+="\\"),n+=e[t];return n};var oe=new WeakMap,ce=new Map,ue=new Map;JSOX.begin=function(y,m){const ne={name:null,value_type:n,string:"",contains:null,className:null},re={line:1,col:1};let oe,ce=0;var fe=new Map,pe=v,ge=!0,he=!1,ye=null,me=null,de=void 0,ve=[],ke={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t,this.length++},pop(){var e=this.last;return e?((this.last=e.prior)||(this.first=null),e.next=this.saved,this.saved=e,this.length--,e.node):null},length:0},Oe=[],je={},xe=null,we=0,_e=-1,Ne=Y,Se=0,Ae=!1,Ie=!1,Je=!1,Pe=!1,Xe=!1,Ee={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t},shift(){var e=this.first;return e?((this.first=e.next)||(this.last=null),e.next=this.saved,this.saved=e,e.node):null},unshift(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=this.first,t.prior=null):t={node:e,next:this.first,prior:null},this.first||(this.last=t),this.first=t}},Me=null,$e=!1,Ce=!1,Fe=!1,Ue=!1,Be=!1,Te=!1,qe=!1,ze=0,De=0,We=!1,He=!1,Le=!1,Qe=!1;return{registerFromJSOX(e,t){if(fe.get(e))throw new Error("Existing fromJSOX has been registered for prototype");fe.set(e,t)},value(){var e=ye;return ye=void 0,e},reset(){pe=v,ge=!0,Ee.last&&(Ee.last.next=Ee.save),Ee.save=Ee.first,Ee.first=Ee.last=null,ke.last&&(ke.last.next=ke.save),ke.save=Ee.first,ke.first=ke.last=null,ve=null,de=void 0,Ne=Y,Oe=[],je={},xe=null,we=0,ne.value_type=n,ne.name=null,ne.string="",ne.className=null,re.line=1,re.col=1,he=!1,Se=0,He=!1,$e=!1,Fe=!1,Ue=!1},usePrototype(e,t){je[e]=t},write(e){var t;for("string"!=typeof e&&(e=String(e)),t=this._write(e,!1);t>0&&(ye&&("function"==typeof m&&function e(t,n){var r,a,s=t[n];if(s&&"object"==typeof s)for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(void 0!==(a=e(s,r))?s[r]=a:delete s[r]);return m.call(t,n,s)}({"":ye},""),y(ye),ye=void 0),!(t<2));t=this._write());},_write(y,m){var Re,Ve,Ye,Ge=0;function Ke(e,t){throw new Error(`${e} '${String.fromCodePoint(t)}' unexpected at ${ce} (near '${Ye.substr(ce>4?ce-4:0,ce>4?3:ce-1)}[${String.fromCodePoint(t)}]${Ye.substr(ce,10)}') [${re.line}:${re.col}]`)}function Ze(){ne.value_type=n,ne.string="",ne.contains=null}function et(){var n=null;switch(ne.value_type){case l:if(Qe){if(e)return BigInt(ne.string);throw new Error("no builtin BigInt()",0)}return Le?new Date(ne.string):function(t){if(Qe){if(e)return BigInt(t);throw new Error("no builtin BigInt()",0)}return Le?new Date(t):t.length>1&&!Ae&&!Ie&&!Je&&48===t.charCodeAt(0)?(he?-1:1)*Number("0o"+t):(he?-1:1)*Number(t)}(ne.string);case i:return ne.className&&((n=fe.get(ne.className))||(n=ue.get(ne.className)),ne.className=null,n)?n.call(ne.string):ne.string;case a:return!0;case s:return!1;case c:case u:return NaN;case f:return-1/0;case p:return 1/0;case r:return null;case t:case g:return;case o:return ne.className&&((n=fe.get(ne.className))||(n=ue.get(ne.className)),ne.className=null,n)?ne.contains=n.call(ne.contains):ne.contains;case h:if(_e>=0){var b=function(e){var t;t=e.length%4==1?3*((e.length+3)/4|0)-3:e.length%4==2?3*((e.length+3)/4|0)-2:e.length%4==3?3*((e.length+3)/4|0)-1:-1==be[e[e.length-3]]?3*((e.length+3)/4|0)-3:-1==be[e[e.length-2]]?3*((e.length+3)/4|0)-2:-1==be[e[e.length-1]]?3*((e.length+3)/4|0)-1:3*((e.length+3)/4|0);var n,r=new ArrayBuffer(t),a=new Uint8Array(r),s=e.length+3>>2;for(n=0;n<s;n++){var i=be[e[4*n]],l=4*n+1<e.length?be[e[4*n+1]]:-1,o=l>=0&&4*n+2<e.length?be[e[4*n+2]]:-1,c=o>=0&&4*n+3<e.length?be[e[4*n+3]]:-1;l>=0&&(a[3*n+0]=i<<2|l>>4),o>=0&&(a[3*n+1]=l<<4|o>>2&15),c>=0&&(a[3*n+2]=o<<6|63&c)}return r}(ne.string);return 0===_e?b:new d[_e](b)}if(-2===_e){var y=me;if(!(y=ne.contains.reduce((e,t)=>Object.getPrototypeOf(e)===Map.prototype?e.get(t):e&&(e=e[t]),y)))throw new Error("Path did not resolve poperly.");return y}return ne.className&&((n=fe.get(ne.className))||(n=ue.get(ne.className)),ne.className=null,n)?n.call(ne.contains):ne.contains;default:console.log("Unhandled value conversion.",ne)}}function tt(){if(-3!=_e){switch(ne.value_type){case g:ve.push(void 0),delete ve[ve.length-1];break;default:ve.push(et())}Ze()}else _e=-1}function nt(){if(-3===_e)return de[ne.name]=et(),void(_e=-1);ne.value_type!==g&&(!ne.name&&xe&&(ne.name=xe.fields[we++]),de[ne.name]=et(),Ze())}function rt(e){if(pe!==v)switch(he&&(valstring+="-",he=!1),pe){case V:switch(ne.value_type){case a:ne.string+="true";break;case s:ne.string+="false";break;case r:ne.string+="null";break;case p:ne.string+="Infinity";break;case f:ne.string+="-Infinity";break;case u:ne.string+="NaN";break;case c:ne.string+="-NaN";break;case t:ne.string+="undefined";break;case i:break;default:console.log("Value of type "+ne.value_type+" is not restored...")}case k:ne.string+="t";break;case O:ne.string+="tr";break;case j:ne.string+="tru";break;case x:ne.string+="f";break;case w:ne.string+="fa";break;case _:ne.string+="fal";break;case N:ne.string+="fals";break;case S:ne.string+="n";break;case A:ne.string+="nu";break;case I:ne.string+="nul";break;case J:ne.string+="u";break;case P:ne.string+="un";break;case X:ne.string+="und";break;case E:ne.string+="unde";break;case M:ne.string+="undef";break;case $:ne.string+="undefi";break;case C:ne.string+="undefin";break;case F:ne.string+="undefine";break;case U:ne.string+="M";break;case B:ne.string+="Na";break;case T:ne.string+="I";break;case q:ne.string+="In";break;case z:ne.string+="Inf";break;case D:ne.string+="Infi";break;case W:ne.string+="Infin";break;case H:ne.string+="Infini";break;case L:ne.string+="Infinit"}if(ne.value_type=i,pe=Q,123==e)it();else if(91==e)lt();else{if(32==e||13==e||10==e||9==e||65279==e||2028==e||2029==e)return;44==e||125==e||93==e||58==e?Ke("Invalid character near identifier",e):ne.string+=oe}}function at(e){let t=0;for(;0==t&&ce<Ye.length;){oe=Ye.charAt(ce);let n=Ye.codePointAt(ce++);if(n>=65536&&(oe+=Ye.charAt(ce),ce++),re.col++,n==e)Fe?(ne.string+=oe,Fe=!1):(t=-1,We?Ke("Incomplete Octal sequence",n):qe?Ke("Incomplete hexidecimal sequence",n):Te?Ke("Incomplete unicode sequence",n):Be&&Ke("Incomplete long unicode sequence",n),t=1);else if(Fe){if(We){if(De<3&&n>=48&&n<=57){if(ze*=8,ze+=n-48,3===++De){ne.string+=String.fromCodePoint(ze),We=!1,Fe=!1;continue}continue}if(ze>255){Ke("(escaped character, parsing octal escape val=%d) fault while parsing",n),t=-1;break}ne.string+=String.fromCodePoint(ze),We=!1,Fe=!1;continue}if(Be){if(125==n){ne.string+=String.fromCodePoint(ze),Be=!1,Te=!1,Fe=!1;continue}if(ze*=16,n>=48&&n<=57)ze+=n-48;else if(n>=65&&n<=70)ze+=n-65+10;else{if(!(n>=97&&n<=102)){Ke("(escaped character, parsing hex of \\u)",n),t=-1,Be=!1,Fe=!1;continue}ze+=n-97+10}continue}if(qe||Te){if(0===De&&123===n){Be=!0;continue}if(De<2||Te&&De<4){if(ze*=16,n>=48&&n<=57)ze+=n-48;else if(n>=65&&n<=70)ze+=n-65+10;else{if(!(n>=97&&n<=102)){Ke(Te?"(escaped character, parsing hex of \\u)":"(escaped character, parsing hex of \\x)",n),t=-1,qe=!1,Fe=!1;continue}ze+=n-97+10}De++,Te?4==De&&(ne.string+=String.fromCodePoint(ze),Te=!1,Fe=!1):2==De&&(ne.string+=String.fromCodePoint(ze),qe=!1,Fe=!1);continue}}switch(n){case 13:Ue=!0,re.col=1;continue;case 10:case 2028:case 2029:re.line++;break;case 116:ne.string+="\t";break;case 98:ne.string+="\b";break;case 110:ne.string+="\n";break;case 114:ne.string+="\r";break;case 102:ne.string+="\f";break;case 48:case 49:case 50:case 51:We=!0,ze=n-48,De=1;continue;case 120:qe=!0,De=0,ze=0;continue;case 117:Te=!0,De=0,ze=0;continue;default:ne.string+=oe}Fe=!1}else if(92===n)Fe?(ne.string+="\\",Fe=!1):Fe=!0;else{if(Ue){if(Ue=!1,10==n){re.line++,re.col=1,Fe=!1;continue}re.line++,re.col=1;continue}ne.string+=oe}}return t}function st(){let e;for(;(e=ce)<Ye.length;){oe=Ye.charAt(e);let t=Ye.codePointAt(ce++);if(t>=65536&&(Ke("fault while parsing number;",t),oe+=Ye.charAt(ce),ce++),95!=t)if(re.col++,t>=48&&t<=57)Je&&(Xe=!0),ne.string+=oe;else if(45==t||43==t)0==ne.string.length||Je&&!Pe&&!Xe?(ne.string+=oe,Pe=!0):(ne.string+=oe,Le=!0);else if(58==t&&Le)ne.string+=oe,Le=!0;else if(84==t&&Le)ne.string+=oe,Le=!0;else if(90==t&&Le)ne.string+=oe,Le=!0;else if(46==t){if(Ie||Ae||Je){ge=!1,Ke("fault while parsing number;",t);break}ne.string+=oe,Ie=!0}else{if(110==t){Qe=!0;break}if(120==t||98==t||111==t||88==t||66==t||79==t){if(Ae||"0"!=ne.string){ge=!1,Ke("fault while parsing number;",t);break}Ae=!0,ne.string+=oe}else{if(101!=t&&69!=t){if(32==t||13==t||10==t||9==t||65279==t||44==t||125==t||93==t||58==t){ce=e;break}m&&(ge=!1,Ke("fault while parsing number;",t));break}if(Je){ge=!1,Ke("fault while parsing number;",t);break}ne.string+=oe,Je=!0}}}m||ce!=Ye.length?(Ce=!1,ne.value_type=l,Ne==Y&&(He=!0)):Ce=!0}function it(){let e,t=null,n={};if(pe>v&&pe<Q&&rt(),Ne==Y)pe==Q&&ne.string.length?(fe.get(ne.string)?ne.className=ne.string:ue.get(ne.string)&&(ne.className=ne.string),(t=Oe.find(e=>e.name===ne.string))?(n=Object.assign(n,t.protoObject),Object.setPrototypeOf(n,Object.getPrototypeOf(t.protoObject)),e=te):(Oe.push(t={name:ne.string,protoObject:je[ne.string]||Object.create({}),fields:[]}),e=ee),pe=v):(e=K,pe=Q);else if(pe==Q||Ne===G||Ne===Z)pe!=v?(fe.get(ne.string)?ne.className=ne.string:ue.get(ne.string)?ne.className=ne.string:((t=Oe.find(e=>e.name===ne.string))||Ke("Referenced class "+ne.string+" has not been defined",Re),n=Object.assign(n,t.protoObject),Object.setPrototypeOf(n,Object.getPrototypeOf(t.protoObject))),e=te,pe=v):(e=K,pe=v);else{if(Ne==K&&pe==v)return Ke("fault while parsing; getting field name unexpected ",Re),ge=!1,!1;e=K}{let r=ae();ne.value_type=o,Ne===Y?de=n:Ne==G?-1==_e&&ve.push(n):Ne!=Z&&Ne!=te||(!ne.name&&xe&&(ne.name=xe.fields[we++]),de[ne.name]=n),r.context=Ne,r.elements=de,r.element_array=ve,r.name=ne.name,r.current_class=xe,r.current_class_field=we,r.arrayType=-1==_e?-3:_e,r.className=ne.className,ne.className=null,ne.name=null,xe=t,we=0,de=n,me||(me=de),ke.push(r),Ze(),Ne=e}return!0}function lt(){if(pe>v&&pe<Q&&rt(),pe==Q&&ne.string.length){var e=b.findIndex(e=>e===ne.string);e>=0?(pe=v,_e=e):"ref"===ne.string?(ne.className=null,_e=-2):fe.get(ne.string)?ne.className=ne.string:ue.get(ne.string)?ne.className=ne.string:Ke("Unknown type specified for array:"+ne.string,Re)}else if(Ne==K||pe==Q||pe==R)return Ke("Fault while parsing; while getting field name unexpected",Re),ge=!1,!1;{let e=ae();ne.value_type=h;let t=[];Ne==Y?ve=t:Ne==G?-1==_e&&ve.push(t):Ne==Z&&(de[ne.name]=t),e.context=Ne,e.elements=de,e.element_array=ve,e.name=ne.name,e.current_class=xe,e.current_class_field=we,e.arrayType=-1==_e?-3:_e,e.className=ne.className,_e=-1,ne.className=null,ne.name=null,xe=null,we=0,ve=t,me||(me=ve),ke.push(e),Ze(),Ne=G}return!0}if(!ge)return-1;for(y&&y.length?((Ve=function(){var e=ie.pop();return e?e.n=0:e={buf:null,n:0},e}()).buf=y,Ee.push(Ve)):Ce&&(Ce=!1,ne.value_type=l,Ne==Y&&(He=!0),Ge=1);ge&&(Ve=Ee.shift());){if(ce=Ve.n,Ye=Ve.buf,$e){let e=at(Me);e<0?ge=!1:e>0&&($e=!1,ge&&(ne.value_type=i))}for(Ce&&st();!He&&ge&&ce<Ye.length;){if(oe=Ye.charAt(ce),(Re=Ye.codePointAt(ce++))>=65536&&(oe+=Ye.charAt(ce),ce++),re.col++,Se){if(1==Se){if(42==Re){Se=3;continue}47!=Re?(Ke("fault while parsing;",Re),ge=!1):Se=2;continue}if(2==Se){if(10==Re){Se=0;continue}continue}if(3==Se){if(42==Re){Se=4;continue}continue}if(4==Se){if(47==Re){Se=0;continue}42!=Re&&(Se=3);continue}}switch(Re){case 47:Se||(Se=1);break;case 123:it();break;case 91:lt();break;case 58:if(Ne==te)pe=v,ne.name=ne.string,ne.string="",ne.value_type=n;else if(Ne==K||Ne==ee){if(pe!=v&&pe!=Q&&pe!=R){ge=!1,Ke(`fault while parsing; unquoted keyword used as object field name (state:${pe})`,Re);break}pe=v,ne.name=ne.string,ne.string="",Ne=Ne===K?Z:8,ne.value_type=n}else Ke(Ne==G?"(in array, got colon out of string):parsing fault;":"(outside any object, got colon out of string):parsing fault;",Re),ge=!1;break;case 125:if(pe==V&&(pe=v),Ne==ee)if(xe){ne.string&&(xe.protoObject[ne.string]=void 0,xe.fields.push(ne.string)),Ze();let e=ke.pop();Ne=Y,pe=v,ne.name=e.name,de=e.elements,ve=e.element_array,xe=e.current_class,we=e.current_class_field,_e=e.arrayType,ne.className=e.className,me=null,se(e)}else Ke("State error; gathering class fields, and lost the class",Re);else if(Ne==K||Ne==te){ne.value_type!=n&&(xe&&(ne.name=xe.fields[we++]),nt()),ne.value_type=o,ne.contains=de,ne.string="";let e=ke.pop();Ne=e.context,ne.name=e.name,de=e.elements,ve=e.element_array,xe=e.current_class,we=e.current_class_field,_e=e.arrayType,ne.className=e.className,se(e),Ne==Y&&(He=!0)}else if(Ne==Z){ne.value_type!=n&&nt(),ne.value_type=o,ne.contains=de;var ot=ke.pop();ne.name=ot.name,Ne=ot.context,ne.name=ot.name,de=ot.elements,xe=ot.current_class,we=ot.current_class_field,_e=ot.arrayType,ne.className=ot.className,ve=ot.element_array,se(ot),Ne==Y&&(He=!0)}else Ke("Fault while parsing; unexpected",Re),ge=!1;he=!1;break;case 93:if(pe==V&&(pe=v),Ne==G){ne.value_type!=n&&tt(),ne.contains=ve;ot=ke.pop();ne.name=ot.name,ne.className=ot.className,Ne=ot.context,de=ot.elements,ve=ot.element_array,xe=ot.current_class,we=ot.current_class_field,_e=ot.arrayType,se(ot),ne.value_type=h,Ne==Y&&(He=!0)}else Ke(`bad context ${Ne}; fault while parsing`,Re),ge=!1;he=!1;break;case 44:pe!=V&&pe!=Q||(pe=v),Ne==ee?xe?(xe.protoObject[ne.string]=void 0,xe.fields.push(ne.string),ne.string="",pe=Q):Ke("State error; gathering class fields, and lost the class",Re):Ne==K?xe?(ne.name=xe.fields[we++],ne.value_type!=n&&(nt(),Ze())):(ne.string||ne.value_type)&&Ke("State error; comma in field name and/or lost the class",Re):Ne==te?(xe?(-3==_e||ne.name||(ne.name=xe.fields[we++]),ne.value_type!=n&&(-3!=_e&&nt(),Ze())):pe=v,ne.name=null):Ne==G?(ne.value_type==n&&(ne.value_type=g),ne.value_type!=n&&(tt(),Ze())):Ne==Z?(Ne=K,ne.value_type!=n&&(nt(),Ze()),pe=v):(ge=!1,Ke("bad context; excessive commas while parsing;",Re)),he=!1;break;default:if(Ne==Y||Ne==Z&&pe==Q||Ne==K||Ne==ee)switch(Re){case 96:case 34:case 39:if(pe==v||pe==Q){ne.string.length&&(ne.className=ne.string,ne.string=""),at(Re)?ne.value_type=i:(Me=Re,$e=!0)}else Ke("fault while parsing; quote not at start of field name",Re);break;case 10:re.line++,re.col=1;case 13:case 32:case 9:case 65279:if(pe===V){pe=v,Ne===Y&&(He=!0);break}if(pe===v||pe===R){Ne==Y&&ne.value_type&&(He=!0);break}if(pe===Q){if(Ne===Y){pe=v,He=!0;break}ne.string.length&&(pe=R)}else ge=!1,Ke("fault while parsing; whitepsace unexpected",Re);break;default:if(pe==v&&(Re>=48&&Re<=57||43==Re||46==Re||45==Re)){Ae=!1,Je=!1,Le=!1,Qe=!1,Pe=!1,Xe=!1,Ie=!1,ne.string=oe,Ve.n=ce,st();break}pe===R&&(ge=!1,Ke("fault while parsing; character unexpected",Re)),pe===v&&(pe=Q,ne.value_type=i),ne.string+=oe}else switch(Re){case 96:case 34:case 39:at(Re)?(ne.value_type=i,pe=V):(Me=Re,$e=!0);break;case 10:re.line++,re.col=1;case 32:case 9:case 13:case 2028:case 2029:case 65279:if(pe==V){pe=v,Ne==Y&&(He=!0);break}if(pe==v||pe==R)break;pe==Q?ne.string.length&&(pe=R):(ge=!1,Ke("fault parsing whitespace",Re));break;case 116:pe==v?pe=k:pe==H?pe=L:rt(Re);break;case 114:pe==k?pe=O:rt(Re);break;case 117:pe==O?pe=j:pe==S?pe=A:pe==v?pe=J:rt(Re);break;case 101:pe==j?(ne.value_type=a,pe=V):pe==N?(ne.value_type=s,pe=V):pe==X?pe=E:pe==C?pe=F:rt(Re);break;case 110:pe==v?pe=S:pe==J?pe=P:pe==$?pe=C:pe==T?pe=q:pe==D?pe=W:rt(Re);break;case 100:pe==P?pe=X:pe==F?(ne.value_type=t,pe=V):rt(Re);break;case 105:pe==M?pe=$:pe==z?pe=D:pe==W?pe=H:rt(Re);break;case 108:pe==A?pe=I:pe==I?(ne.value_type=r,pe=V):pe==w?pe=_:rt(Re);break;case 102:pe==v?pe=x:pe==E?pe=M:pe==q?pe=z:rt(Re);break;case 97:pe==x?pe=w:pe==U?pe=B:rt(Re);break;case 115:pe==_?pe=N:rt(Re);break;case 73:pe==v?pe=T:rt(Re);break;case 78:pe==v?pe=U:pe==B?(ne.value_type=he?c:u,he=!1,pe=V):rt(Re);break;case 121:pe==L?(ne.value_type=he?f:p,he=!1,pe=V):rt(Re);break;case 45:pe==v?he=!he:rt(Re);break;default:pe==v&&(Re>=48&&Re<=57||43==Re||46==Re||45==Re)?(Ae=!1,Je=!1,Le=!1,Qe=!1,Pe=!1,Xe=!1,Ie=!1,ne.string=oe,Ve.n=ce,st()):rt(Re)}}if(He){pe==V&&(pe=v);break}}if(ce==Ye.length?(le(Ve),$e||Ce||Ne==K?Ge=0:Ne!=Y||ne.value_type==n&&!ye||(He=!0,Ge=1)):(Ve.n=ce,Ee.unshift(Ve),Ge=2),He){me=null;break}}return ge?(He&&ne.value_type!=n&&(ye=et(),he=!1,ne.string="",ne.value_type=n),He=!1,Ge):-1}}};const fe=[Object.freeze(JSOX.begin())];var pe=0;JSOX.parse=function(e,t){var n,r=pe++;if(fe.length<=r&&fe.push(Object.freeze(JSOX.begin())),n=fe[r],"string"!=typeof e&&(e=String(e)),n.reset(),n._write(e,!0)>0){var a=n.value();"function"==typeof t&&function e(n,r){var a,s,i=n[r];if(i&&"object"==typeof i)for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(void 0!==(s=e(i,a))?i[a]=s:delete i[a]);return t.call(n,r,i)}({"":a},"");return pe--,a}};{function ge(){return this&&this.valueOf()}oe.set(Object.prototype,{external:!1,name:Object.prototype.constructor.name,cb:null}),oe.set(Date.prototype,{external:!1,name:"Date",cb:function(){var e,t,n=-this.getTimezoneOffset(),r=n>=0?"+":"-",a=function(e){var t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return[this.getFullYear(),"-",a(this.getMonth()+1),"-",a(this.getDate()),"T",a(this.getHours()),":",a(this.getMinutes()),":",a(this.getSeconds()),"."+(e=this.getMilliseconds(),t=Math.floor(Math.abs(e)),(t<100?"0":"")+(t<10?"0":"")+t)+r,a(n/60),":",a(n%60)].join("")}}),oe.set(Boolean.prototype,{external:!1,name:"Boolean",cb:ge}),oe.set(Number.prototype,{external:!1,name:"Number",cb:function(){return isNaN(this)?"NaN":isFinite(this)?String(this):this<0?"-Infinity":"Infinity"}}),oe.set(String.prototype,{external:!1,name:"String",cb:function(){return'"'+JSOX.escape(ge.apply(this))+'"'}}),"function"==typeof BigInt&&oe.set(BigInt.prototype,{external:!1,name:"BigInt",cb:function(){return this+"n"}}),oe.set(ArrayBuffer.prototype,{external:!0,name:"ab",cb:function(){return"["+me(this)+"]"}}),oe.set(Uint8Array.prototype,{external:!0,name:"u8",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Uint8ClampedArray.prototype,{external:!0,name:"uc8",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Int8Array.prototype,{external:!0,name:"s8",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Uint16Array.prototype,{external:!0,name:"u16",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Int16Array.prototype,{external:!0,name:"s16",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Uint32Array.prototype,{external:!0,name:"u32",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Int32Array.prototype,{external:!0,name:"s32",cb:function(){return"["+me(this.buffer)+"]"}}),"undefined"!=typeof Uint64Array&&oe.set(Uint64Array.prototype,{external:!0,name:"u64",cb:function(){return"["+me(this.buffer)+"]"}}),"undefined"!=typeof Int64Array&&oe.set(Int64Array.prototype,{external:!0,name:"s64",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Float32Array.prototype,{external:!0,name:"f32",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Float64Array.prototype,{external:!0,name:"f64",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Float64Array.prototype,{external:!0,name:"f64",cb:function(){return"["+me(this.buffer)+"]"}}),oe.set(Map.prototype,m={external:!0,name:"map",cb:null}),ue.set("map",function(){var e=new Map;for(key in this)e.set(key,this[key]);return e}),oe.set(Array.prototype,y={external:!1,name:Array.prototype.constructor.name,cb:null})}JSOX.registerToJSOX=function(e,t,n){if(t.prototype&&t.prototype===Object.prototype){var r=Object.keys(t).toString();if(ce.get(r))throw new Error("Existing toJSOX has been registered for object type");ce.set(r,{external:!0,name:e,cb:n})}else{if(oe.get(t))throw new Error("Existing toJSOX has been registered for prototype");oe.set(t,{external:!0,name:e||n.constructor.name,cb:n})}},JSOX.registerFromJSOX=function(e,t){if(ue.get(e))throw new Error("Existing fromJSOX has been registered for prototype");ue.set(e,t)},JSOX.registerToFrom=function(e,t,n,r){JSOX.registerToJSOX(e,t,n),JSOX.registerFromJSOX(e,r)},JSOX.stringifier=function(){var e=[],t='"',n=new WeakMap,r=[],a=new WeakMap,s=new Map;return{defineClass(t,n){var r;e.push(r={name:t,tag:Object.keys(n).toString(),proto:Object.getPrototypeOf(n),fields:Object.keys(n)});for(var a=1;a<r.fields.length;a++)if(r.fields[a]<r.fields[a-1]){let e=r.fields[a-1];r.fields[a-1]=r.fields[a],r.fields[a]=e,a>1&&(a-=2)}r.proto===Object.getPrototypeOf({})&&(r.proto=null)},stringify:(o,c,u)=>(function(o,c,u){if(void 0===o)return"undefined";if(null===o)return;var f,p,g,h,b=!0;const d=typeof u,v=typeof c;if(f="",p="","number"===d)for(h=0;h<u;h+=1)p+=" ";else"string"===d&&(p=u);if(g=c,c&&"function"!==v&&("object"!==v||"number"!=typeof c.length))throw new Error("JSOX.stringify");return r=[],n=new WeakMap,function t(n,o){function c(){var e=[];let n=r.length;for(let a=0;a<this.length;a+=1)r[n]=a,e[a]=t(a,this)||"null";return r.splice(n,1),0===e.length?"[]":f?["[\n",f,e.join(",\n"+f),"\n",w,"]"].join(""):"["+e.join(",")+"]"}function u(){var e={tmp:null},n="{",a=!0;for(var[s,i]of this){e.tmp=i;var l=r.length;r[l]=s,n+=(a?"":",")+k(s)+":"+t("tmp",e),r.length=l,a=!1}return n+="}"}var h,d,v,O;b&&(y.cb=c,m.cb=function u(){var t={tmp:null},n="{",o=!0;for(var[c,u]of this){t.tmp=u;var h=r.length;r[h]=c,n+=(o?"":",")+k(c)+":"+function t(n,o){function c(){var e=[];let n=r.length;for(let a=0;a<this.length;a+=1)r[n]=a,e[a]=t(a,this)||"null";return r.splice(n,1),0===e.length?"[]":f?["[\n",f,e.join(",\n"+f),"\n",w,"]"].join(""):"["+e.join(",")+"]"}function u(){var e={tmp:null},n="{",a=!0;for(var[s,i]of this){e.tmp=i;var l=r.length;r[l]=s,n+=(a?"":",")+k(s)+":"+t("tmp",e),r.length=l,a=!1}return n+="}"}var h,d,v,O;b&&(y.cb=c,m.cb=u,b=!1),y.cb=c;var j,x,w=f;let _=r.length;var N=o[n],S=null!=N&&(a.get(Object.getPrototypeOf(N))||oe.get(Object.getPrototypeOf(N))||null),A=!S&&null!=N&&(s.get(Object.keys(N).toString())||ce.get(Object.keys(N).toString())||null),I=S&&S.cb||A&&A.cb;if(null!=N&&"function"==typeof I){if(f+=p,"object"==typeof N&&(v=i(N)))return"ref"+v;let e=I.apply(N);N=e,f=w}else if("object"==typeof N&&(v=i(N)))return"ref"+v;switch("function"==typeof g&&(N=g.call(o,n,N)),typeof N){case"string":case"number":{let t="";return""===n&&(t=e.map(e=>e.name+"{"+e.fields.join(",")+"}").join(f?"\n":"")+(f?"\n":"")),S&&S.external?t+S.name+N:A&&A.external?t+A.name+N:t+N}case"boolean":case"null":return String(N);case"object":if(v)return"ref"+v;if(!N)return"null";if(f+=p,j=null,x=[],g&&"object"==typeof g){for(O=g.length,j=l(N,g),h=0;h<O;h+=1)"string"==typeof g[h]&&(d=g[h],r[_]=d,(v=t(d,N))&&(j?x.push(v):x.push(k(d)+(f?": ":":")+v)));r.splice(_,1)}else{j=l(N);var J=[];for(d in N)if(Object.prototype.hasOwnProperty.call(N,d)){var P;for(P=0;P<J.length;P++)if(J[P]>d){J.splice(P,0,d);break}P==J.length&&J.push(d)}for(P=0;P<J.length;P++)d=J[P],Object.prototype.hasOwnProperty.call(N,d)&&(r[_]=d,(v=t(d,N))&&(j?x.push(v):x.push(k(d)+(f?": ":":")+v)));r.splice(_,1)}{let t;t=""===n?e.map(e=>e.name+"{"+e.fields.join(",")+"}").join(f?"\n":"")+(f?"\n":""):"",S&&S.external&&(""===n?t+=S.name:t=t+'"'+S.name+'"');var X=null;j&&(X=k(j.name)),v=t+(0===x.length?"{}":f?(j?X:"")+"{\n"+f+x.join(",\n"+f)+"\n"+w+"}":(j?X:"")+"{"+x.join(",")+"}")}return f=w,v}}("tmp",t),r.length=h,o=!1}return n+="}"},b=!1),y.cb=c;var j,x,w=f;let _=r.length;var N=o[n],S=null!=N&&(a.get(Object.getPrototypeOf(N))||oe.get(Object.getPrototypeOf(N))||null),A=!S&&null!=N&&(s.get(Object.keys(N).toString())||ce.get(Object.keys(N).toString())||null),I=S&&S.cb||A&&A.cb;if(null!=N&&"function"==typeof I){if(f+=p,"object"==typeof N&&(v=i(N)))return"ref"+v;let e=I.apply(N);N=e,f=w}else if("object"==typeof N&&(v=i(N)))return"ref"+v;switch("function"==typeof g&&(N=g.call(o,n,N)),typeof N){case"string":case"number":{let t="";return""===n&&(t=e.map(e=>e.name+"{"+e.fields.join(",")+"}").join(f?"\n":"")+(f?"\n":"")),S&&S.external?t+S.name+N:A&&A.external?t+A.name+N:t+N}case"boolean":case"null":return String(N);case"object":if(v)return"ref"+v;if(!N)return"null";if(f+=p,j=null,x=[],g&&"object"==typeof g){for(O=g.length,j=l(N,g),h=0;h<O;h+=1)"string"==typeof g[h]&&(d=g[h],r[_]=d,(v=t(d,N))&&(j?x.push(v):x.push(k(d)+(f?": ":":")+v)));r.splice(_,1)}else{j=l(N);var J=[];for(d in N)if(Object.prototype.hasOwnProperty.call(N,d)){var P;for(P=0;P<J.length;P++)if(J[P]>d){J.splice(P,0,d);break}P==J.length&&J.push(d)}for(P=0;P<J.length;P++)d=J[P],Object.prototype.hasOwnProperty.call(N,d)&&(r[_]=d,(v=t(d,N))&&(j?x.push(v):x.push(k(d)+(f?": ":":")+v)));r.splice(_,1)}{let t;t=""===n?e.map(e=>e.name+"{"+e.fields.join(",")+"}").join(f?"\n":"")+(f?"\n":""):"",S&&S.external&&(""===n?t+=S.name:t=t+'"'+S.name+'"');var X=null;j&&(X=k(j.name)),v=t+(0===x.length?"{}":f?(j?X:"")+"{\n"+f+x.join(",\n"+f)+"\n"+w+"}":(j?X:"")+"{"+x.join(",")+"}")}return f=w,v}}("",{"":o});function k(e){return isNaN(e)?e in ne||/([0-9\-])/.test(e[0])||/((\n|\r|\t)|[ \{\}\(\)\<\>\!\+\-\*\/\.\:\, ])/.test(e)?t+JSOX.escape(e)+t:e:["'",e.toString(),"'"].join("")}})(o,c,u),setQuote(e){t=e},registerToJSOX(e,t,n){if(t.prototype&&t.prototype!==Object.prototype){if(a.get(t))throw new Error("Existing toJSOX has been registered for prototype");a.set(t,{external:!0,name:e||n.constructor.name,cb:n})}else{var r=Object.keys(t).toString();if(s.get(r))throw new Error("Existing toJSOX has been registered for object type");s.set(r,{external:!0,name:e,cb:n})}}};function i(e){if(null!==e){var t=n.get(e);if(t)return t;n.set(e,_JSON.stringify(r))}}function l(t,n){var r,a,s=Object.getPrototypeOf(t);return(a=e.find(e=>{if(e.proto&&e.proto===s)return!0}))?a:(n?(n=n.map(e=>"string"==typeof e?e:void 0),r=n.toString()):r=Object.keys(t).toString(),a=e.find(e=>{if(e.tag===r)return!0}))}};const he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be={"~":-1,"=":-1,$:62,_:63,"+":62,"-":62,".":62,"/":63,",":63};for(var ye=0;ye<256;ye++)ye<64&&(be[he[ye]]=ye);function me(e){for(var t,n,r,a,s="",i=new Uint8Array(e),l=i.byteLength,o=l%3,c=l-o,u=0;u<c;u+=3)t=(258048&(a=i[u]<<16|i[u+1]<<8|i[u+2]))>>12,n=(4032&a)>>6,r=63&a,s+=he[(16515072&a)>>18]+he[t]+he[n]+he[r];return 1==o?(t=(3&(a=i[c]))<<4,s+=he[(252&a)>>2]+he[t]+"=="):2==o&&(t=(1008&(a=i[c]<<8|i[c+1]))>>4,n=(15&a)<<2,s+=he[(64512&a)>>10]+he[t]+he[n]+"="),s}Object.freeze(be),JSOX.stringify=function(e,t,n){return JSOX.stringifier().stringify(e,t,n)};[[0,384,[16767487,16739071,130048,3670016,0,16777208,16777215,8388607,8388608,0,128,0,0,0,0,0]]].map(e=>({firstChar:e[0],lastChar:e[1],bits:e[2]}))}privateizeEverything();var jsox=Object.freeze({});function getCjsExportFromNamespace(e){return e&&e.default||e}var require$$0=getCjsExportFromNamespace(jsox),lib=require$$0;export default lib;
